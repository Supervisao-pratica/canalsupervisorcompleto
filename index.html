<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Portal do Supervisor da Prática - Senac PR</title>
    
    <!-- 1. BIBLIOTECAS DO PAINEL BI (Adicionadas) -->
    <!-- Tailwind CSS com PREFLIGHT DESATIVADO para não quebrar seu site original -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            corePlugins: {
                preflight: false, // Isso impede que o Tailwind resete os estilos do seu site
            }
        }
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- 2. ÍCONES E FONTES DO SEU SITE ORIGINAL -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* =========================================
           ESTILO VISUAL ORIGINAL (CSS NATIVO)
           (Mantido 100% igual ao fornecido)
           ========================================= */
        :root {
            --senac-blue: #004587;
            --senac-dark-blue: #003366;
            --senac-orange: #F68B1F;
            --senac-green: #16a34a;
            --bg-color: #f8fafc;
            --text-color: #374151;
            --border-color: #e5e7eb;
            --white: #ffffff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Roboto', 'Segoe UI', 'Arial', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            line-height: 1.5;
            overflow-y: auto;
        }

        body.locked { overflow: hidden !important; height: 100vh; }

        a { text-decoration: none; color: inherit; }
        ul { list-style: none; }
        img { max-width: 100%; display: block; }
        button { cursor: pointer; border: none; background: none; font-family: inherit; }

        /* Utilitários */
        .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }
        .hidden-section { display: none !important; }
        
        /* TELA DE LOGIN */
        #login-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, var(--senac-blue) 0%, var(--senac-dark-blue) 100%);
            z-index: 9999;
            display: flex; align-items: center; justify-content: center;
        }
        .login-box {
            background: white; padding: 50px 40px; border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            width: 90%; max-width: 400px; text-align: center;
        }
        .login-title { color: var(--senac-blue); margin-bottom: 10px; font-size: 1.5rem; font-weight: bold; }
        .login-desc { color: #666; font-size: 14px; margin-bottom: 30px; line-height: 1.6; }

        .password-container { position: relative; margin-bottom: 20px; text-align: left; }
        .password-label { font-size: 12px; font-weight: bold; color: var(--senac-blue); margin-bottom: 5px; display: block; text-transform: uppercase; }
        .password-input {
            width: 100%; padding: 12px 15px; font-size: 16px;
            border: 2px solid #e5e7eb; border-radius: 6px; outline: none;
            transition: border-color 0.2s;
        }
        .password-input:focus { border-color: var(--senac-orange); }
        .password-input.error { border-color: #dc2626; background-color: #fef2f2; }
        
        .error-msg { 
            color: #dc2626; font-size: 13px; margin-top: 5px; display: none; font-weight: bold;
            align-items: center; gap: 5px;
        }

        .btn-primary {
            width: 100%; background-color: var(--senac-orange); color: white;
            font-weight: bold; padding: 14px; border-radius: 6px;
            font-size: 16px; transition: background 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-primary:hover { background-color: #d97706; }

        /* MENU E NAVEGAÇÃO */
        .navbar { background-color: white; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 90; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; height: 80px; }
        .logo-area { display: flex; align-items: center; }
        .logo-area img { height: 40px; margin-right: 15px; }
        .logo-text { font-size: 1.125rem; font-weight: bold; color: var(--senac-blue); border-left: 1px solid #ddd; padding-left: 15px; }
        .nav-links { display: flex; gap: 5px; }
        .nav-btn { padding: 26px 15px; font-weight: 600; color: #6b7280; border-bottom: 3px solid transparent; transition: all 0.3s; }
        .nav-btn:hover { color: var(--senac-blue); }
        .nav-btn.active { color: var(--senac-blue); border-bottom-color: var(--senac-orange); }
        
        .navbar-actions { display: flex; align-items: center; gap: 10px; }
        /* CORREÇÃO DO BOTÃO BLACKBOARD */
        .blackboard-btn { background-color: var(--senac-blue); color: white !important; padding: 10px 20px; border-radius: 6px; font-weight: 500; font-size: 0.875rem; transition: background 0.3s; }
        .blackboard-btn:hover { background-color: var(--senac-dark-blue); }
        .logout-btn { color: #dc2626; font-weight: bold; font-size: 0.875rem; padding: 10px; border: 1px solid #fee2e2; border-radius: 6px; transition: 0.3s; }
        .logout-btn:hover { background-color: #fef2f2; }

        /* ESTILOS GERAIS */
        .hero { background: linear-gradient(to right, var(--senac-blue), var(--senac-dark-blue)); color: white; padding: 60px 0; text-align: center; }
        .hero h1 { font-size: 2.25rem; margin-bottom: 10px; }
        
        /* BOAS-VINDAS */
        .welcome-section {
            display: flex; justify-content: center; align-items: center;
            padding: 60px 0; background-color: var(--senac-blue); margin: 0 -20px 0 -20px; 
        }
        .welcome-card {
            background-color: var(--white); border-radius: 16px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3); padding: 40px;
            width: 100%; max-width: 1060px; text-align: left;
        }
        .welcome-title {
            font-size: 2rem; font-weight: 900; color: var(--senac-dark-blue);
            margin-bottom: 20px; border-bottom: 3px solid var(--senac-orange); padding-bottom: 10px;
        }
        .welcome-text { font-size: 1.1rem; line-height: 1.8; color: #1f2937; }
        .welcome-text strong { color: var(--senac-dark-blue); font-weight: 900; }
        .welcome-card::after {
            content: ''; display: block; height: 10px; background-color: var(--senac-dark-blue);
            border-radius: 0 0 16px 16px; margin: 40px -40px -40px -40px; box-shadow: 0 5px 15px rgba(0,0,0,0.1) inset;
        }

        /* CRONOGRAMA */
        .timeline-container { position: relative; padding: 40px 0; }
        .timeline-line::before { content: ''; position: absolute; top: 0; bottom: 0; left: 50%; width: 4px; background: #e2e8f0; transform: translateX(-50%); z-index: 0; }
        .phase-badge { position: relative; z-index: 10; margin-bottom: 50px; text-align: center; }
        .phase-badge span { display: inline-block; padding: 8px 24px; border-radius: 50px; font-weight: bold; font-size: 0.875rem; text-transform: uppercase; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); border: 4px solid var(--bg-color); color: white; }
        .phase-blue span { background: var(--senac-blue); }
        .phase-orange span { background: var(--senac-orange); }
        .phase-green span { background: var(--senac-green); }
        .timeline-step { display: flex; align-items: center; justify-content: space-between; margin-bottom: 40px; position: relative; }
        
        .step-content {
            width: 45%; background: white; padding: 20px; border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); z-index: 1; transition: all 0.2s; cursor: pointer;
        }
        .step-content:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,69,135,0.15); border-color: var(--senac-orange); }
        .step-content:active { transform: translateY(0); }

        .step-content h3 { color: var(--senac-blue); font-size: 1.125rem; margin-bottom: 5px; }
        .step-content p { font-size: 0.875rem; color: #4b5563; }
        .step-number {
            width: 50px; height: 50px; border-radius: 50%; background: var(--senac-blue); color: white;
            display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.125rem;
            border: 4px solid white; box-shadow: 0 1px 3px rgba(0,0,0,0.1); z-index: 10;
        }
        .step-number.bg-orange { background: var(--senac-orange); }
        .step-number.bg-green { background: var(--senac-green); }
        .border-left-orange { border-left: 4px solid var(--senac-orange); }
        .border-right-blue { border-right: 4px solid var(--senac-blue); text-align: right; }
        .border-left-blue { border-left: 4px solid var(--senac-blue); }
        .border-right-orange { border-right: 4px solid var(--senac-orange); text-align: right; }
        .border-left-green { border-left: 4px solid var(--senac-green); }
        .border-right-green { border-right: 4px solid var(--senac-green); text-align: right; }
        .empty-space { width: 45%; }
        .link-btn {
            display: inline-flex; align-items: center; background-color: #eff6ff; color: var(--senac-blue);
            padding: 6px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: bold; margin-top: 10px;
        }
        .link-btn:hover { background-color: #dbeafe; }

        /* ARTES */
        .timeline-art {
            position: absolute; z-index: 5; width: 250px; height: auto; min-height: 200px;
            background: var(--senac-blue); color: white; box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            border-radius: 8px; overflow: hidden; display: flex; flex-direction: column;
            justify-content: center; padding: 25px 20px; transition: transform 0.3s;
            font-family: 'Roboto', 'Arial', sans-serif; text-decoration: none !important;
            cursor: pointer; border-left: 6px solid var(--senac-orange);
        }
        .timeline-art:hover { transform: scale(1.05) rotate(0deg) !important; z-index: 20; box-shadow: 0 15px 35px rgba(0,0,0,0.4); }
        .art-content { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; position: relative; }
        .art-coat { position: absolute; bottom: -15px; right: -10px; width: 40px; opacity: 0.3; }
        .art-title { font-weight: 900; font-size: 1.1rem; text-transform: uppercase; margin-bottom: 5px; line-height: 1.2; color: white; text-align: left; }
        .art-subtitle { font-weight: 700; color: var(--senac-orange); margin-bottom: 12px; font-size: 0.9rem; text-transform: uppercase; text-align: left; }
        .art-desc { font-size: 0.8rem; line-height: 1.4; color: #e2e8f0; font-weight: 300; text-align: left; margin-bottom: 10px; }
        .timeline-art.art-1 { top: 250px; left: -300px; transform: rotate(-7deg); }
        .timeline-art.art-2 { top: 750px; right: -300px; left: auto; transform: rotate(10deg); }
        .timeline-art.art-3 { top: 1300px; left: -300px; transform: rotate(-4deg); }
        .timeline-art.art-4 { top: 1850px; right: -300px; left: auto; transform: rotate(5deg); }

        /* MODAIS */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 1000;
            display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(5px); opacity: 0; visibility: hidden;
            transition: all 0.3s ease;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }

        .modal-box {
            background: white; padding: 40px 30px; border-radius: 12px;
            width: 90%; max-width: 500px; position: relative;
            text-align: center;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: translateY(20px); transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal-box { transform: translateY(0); }
        
        .modal-glass {
            background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.4); box-shadow: 0 8px 32px 0 rgba(0, 69, 135, 0.25);
            padding: 40px; border-radius: 16px; width: 90%; max-width: 600px;
            position: relative; text-align: left;
            transform: scale(0.95); transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal-glass { transform: scale(1); }

        .glass-header { margin-bottom: 20px; border-bottom: 2px solid var(--senac-orange); padding-bottom: 10px; }
        .glass-title { color: var(--senac-blue); font-size: 1.8rem; font-weight: 900; margin: 0; }
        .glass-subtitle { color: #666; font-size: 0.9rem; text-transform: uppercase; font-weight: bold; margin-top: 5px; }
        .glass-content { font-size: 1.05rem; line-height: 1.6; color: #374151; }

        .close-modal-btn {
            position: absolute; top: 15px; right: 20px; font-size: 28px; color: #9ca3af;
            line-height: 1; transition: 0.2s;
        }
        .close-modal-btn:hover { color: #374151; transform: scale(1.1); }

        .warning-box {
            background-color: #fff7ed; border-left: 4px solid #F68B1F;
            padding: 15px; text-align: left; margin-bottom: 25px;
            display: flex; gap: 15px; align-items: flex-start;
            font-size: 0.95rem; color: #9a3412; border-radius: 4px;
        }
        
        .upload-area {
            border: 2px dashed #d1d5db; padding: 30px 20px; border-radius: 8px;
            background: #f9fafb; margin-bottom: 20px; transition: 0.2s;
        }
        .upload-area:hover { border-color: var(--senac-blue); background: #eff6ff; }

        .region-select {
            width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 6px;
            font-size: 1rem; color: var(--text-color); margin-bottom: 15px;
            outline: none; background-color: white; cursor: pointer;
        }
        .region-select:focus { border-color: var(--senac-blue); }

        /* DOCS & EQUIPE */
        .search-bar-container { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px; }
        .search-input { padding: 10px 20px; border: 1px solid #ccc; border-radius: 50px; width: 300px; outline: none; }
        .search-input:focus { border-color: var(--senac-orange); }
        .grid-docs { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .doc-card { background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px; transition: 0.2s; }
        .doc-card:hover { border-color: #bfdbfe; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .doc-header { display: flex; gap: 15px; }
        .icon-box { width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border-radius: 8px; font-size: 1.25rem; flex-shrink: 0; }
        .ib-blue { background: #eff6ff; color: var(--senac-blue); }
        .ib-orange { background: #fff7ed; color: var(--senac-orange); }
        .doc-info h4 { font-weight: bold; color: #1f2937; margin-bottom: 5px; font-size: 1rem; }
        .doc-info p { font-size: 0.75rem; color: #6b7280; margin-bottom: 10px; }
        .download-link { font-size: 0.875rem; font-weight: bold; color: var(--senac-blue); display: inline-flex; align-items: center; }
        .download-link:hover { text-decoration: underline; }
        .text-orange-hover:hover { color: var(--senac-orange); }
        
        .member-card { background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px; display: flex; align-items: flex-start; }
        .avatar { width: 50px; height: 50px; border-radius: 50%; background: var(--senac-blue); color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; flex-shrink: 0; font-size: 1.2rem; }
        .avatar-gray { background: #9ca3af; }
        .member-info h3 { font-size: 1rem; font-weight: bold; color: #1f2937; }
        .member-role { font-size: 0.75rem; font-weight: bold; color: var(--senac-orange); text-transform: uppercase; margin-bottom: 8px; }
        .member-contact a { display: flex; align-items: center; font-size: 0.875rem; color: #4b5563; margin-top: 4px; }
        .member-contact a:hover { color: var(--senac-blue); }
        .member-contact i { width: 20px; text-align: center; margin-right: 12px; } 

        /* FOOTER & MOBILE */
        footer { background-color: var(--senac-dark-blue); color: white; padding: 50px 0 20px; margin-top: auto; }
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; margin-bottom: 40px; }
        .footer-col h4 { font-size: 1.125rem; font-weight: bold; margin-bottom: 15px; }
        .footer-col a:hover { color: var(--senac-orange); }
        .footer-bottom { border-top: 1px solid #1e40af; padding-top: 20px; text-align: center; font-size: 0.75rem; color: #9ca3af; }
        .mobile-menu-btn { display: none; font-size: 24px; color: #6b7280; }
        .mobile-menu-dropdown { display: none; background: #f9fafb; border-top: 1px solid #eee; }
        .mobile-link { display: block; padding: 12px 20px; color: var(--senac-blue); font-weight: 600; border-bottom: 1px solid #eee; width: 100%; text-align: left;}

        @media (max-width: 1400px) {
            .timeline-art { width: 220px; }
            .timeline-art.art-1 { left: -250px; } .timeline-art.art-2 { right: -250px; } .timeline-art.art-3 { left: -250px; } .timeline-art.art-4 { right: -250px; }
            .art-title { font-size: 0.95rem; } .art-subtitle { font-size: 0.8rem; } .art-desc { font-size: 0.7rem; }
        }
        @media (max-width: 1000px) { .timeline-art { display: none; } }
        @media (max-width: 768px) {
            .nav-links, .blackboard-btn, .logo-text, .logout-btn { display: none; } .navbar-actions { display: none; }
            .mobile-menu-btn { display: block; }
            .timeline-line::before { left: 30px; }
            .timeline-step { flex-direction: column; align-items: flex-start; margin-left: 0; }
            .empty-space { display: none; }
            .step-content { width: 100%; margin-left: 60px; margin-top: -40px; }
            .border-right-blue, .border-right-orange, .border-right-green { text-align: left; border-right: none; border-left: 4px solid; }
            .border-right-blue { border-left-color: var(--senac-blue); }
            .border-right-orange { border-left-color: var(--senac-orange); }
            .border-right-green { border-left-color: var(--senac-green); }
            .welcome-section { margin: 0; padding: 40px 10px; }
            .welcome-card::after { margin: 40px -20px -20px -20px; border-radius: 0 0 16px 16px; }
        }

        /* VÍDEO RESPONSIVO */
        .video-container {
            position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;
            max-width: 100%; background: #000; margin-top: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }

        /* =========================================
           ESTILOS EXTRAS DO PAINEL BI (DADOS)
           (Essenciais para o funcionamento do Tailwind sem preflight)
           ========================================= */
        .text-senac-blue { color: var(--senac-blue); }
        .text-senac-orange { color: var(--senac-orange); }
        .bg-senac-blue { background-color: var(--senac-blue); }
        .bg-senac-orange { background-color: var(--senac-orange); }
        
        /* Card BI estilo moderno */
        .card-bi { 
            background: white; border-radius: 16px; box-shadow: 0 4px 20px -2px rgba(0, 0, 0, 0.05); 
            border: 1px solid #e2e8f0; transition: transform 0.2s, box-shadow 0.2s; 
        }
        .card-bi:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1); }

        /* Botões de Escopo do BI */
        .scope-btn { transition: all 0.2s ease; border-bottom: 3px solid transparent; opacity: 0.6; cursor: pointer; }
        .scope-btn.active { opacity: 1; border-bottom-color: var(--senac-orange); background-color: #f8fafc; color: var(--senac-blue); }

        /* Inputs do BI */
        .money-input { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 8px 12px; font-weight: 600; color: #0f172a; width: 100%; transition: all 0.2s; }
        .money-input:focus { border-color: var(--senac-blue); outline: none; background: white; box-shadow: 0 0 0 3px rgba(0, 69, 135, 0.1); }
        
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
        .loader { border: 3px solid rgba(255,255,255,0.3); border-radius: 50%; border-top: 3px solid #f68d2e; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body id="main-body" class="locked">

    <!-- LOGIN SCREEN -->
    <div id="login-screen">
        <div class="login-box">
            <img src="https://upload.wikimedia.org/wikipedia/commons/8/86/Senac_logo.svg" alt="Senac Logo" style="height: 60px; margin: 0 auto 20px;">
            <h2 class="login-title">Acesso Restrito</h2>
            <p class="login-desc">Insira a senha padrão enviada no e-mail de convite para acessar o portal.</p>
            <form onsubmit="event.preventDefault(); checkPassword();">
                <div class="password-container">
                    <label class="password-label">Senha de Acesso</label>
                    <input type="password" id="password-input" class="password-input" placeholder="Digite a senha..." required>
                    <div id="error-msg" class="error-msg"><i class="fas fa-exclamation-circle"></i> Senha incorreta. Tente novamente.</div>
                </div>
                <button type="submit" class="btn-primary"><i class="fas fa-unlock-alt"></i> Acessar Portal</button>
            </form>
            <p style="font-size: 12px; color: #999; margin-top: 30px;">Senac PR &bull; Departamento Regional</p>
        </div>
    </div>

    <!-- CONTEÚDO DO SITE -->
    <div id="site-content" class="hidden-section flex flex-col min-h-screen">
        <nav class="navbar">
            <div class="container nav-content">
                <div class="logo-area">
                    <a href="#" onclick="switchTab('boas-vindas')" style="display: flex; align-items: center;">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/8/86/Senac_logo.svg" alt="Logo">
                        <span class="logo-text">Portal do Supervisor</span>
                    </a>
                </div>
                <div class="nav-links">
                    <button onclick="switchTab('boas-vindas')" id="btn-boas-vindas" class="nav-btn active">Boas-Vindas</button>
                    <!-- ABA DADOS (Agora com BI) -->
                    <button onclick="switchTab('dados')" id="btn-dados" class="nav-btn">Dados</button>
                    <button onclick="switchTab('fluxograma')" id="btn-fluxograma" class="nav-btn">Fluxograma</button>
                    <button onclick="switchTab('documentos')" id="btn-documentos" class="nav-btn">Documentos</button>
                    <button onclick="switchTab('equipe')" id="btn-equipe" class="nav-btn">Equipe</button>
                </div>
                <div class="navbar-actions">
                    <button onclick="logout()" class="logout-btn">Sair</button>
                    <a href="https://senac.blackboard.com/" target="_blank" class="blackboard-btn">Acessar BlackBoard</a>
                </div>
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()"><i class="fas fa-bars"></i></button>
            </div>
            
            <div class="mobile-menu-dropdown" id="mobile-menu">
                <button onclick="switchTab('boas-vindas')" class="mobile-link">Boas-Vindas</button>
                <button onclick="switchTab('dados')" class="mobile-link">Dados</button>
                <button onclick="switchTab('fluxograma')" class="mobile-link">Fluxograma</button>
                <button onclick="switchTab('documentos')" class="mobile-link">Documentos</button>
                <button onclick="switchTab('equipe')" class="mobile-link">Equipe</button>
                <button onclick="logout()" class="mobile-link" style="color: red;">Sair do Sistema</button>
            </div>
        </nav>

        <div class="hero">
            <div class="container">
                <h1 id="hero-title">Bem-Vindo(a) Supervisor(a)!</h1>
                <p id="hero-subtitle">Portal de apoio para a supervisão da Prática Profissional do Senac PR.</p>
            </div>
        </div>

        <main class="container" style="padding-top: 40px; padding-bottom: 40px; flex-grow: 1;">
            
            <!-- ABA: BOAS-VINDAS -->
            <div id="view-boas-vindas" class="welcome-section">
                <div class="welcome-card">
                    <h2 class="welcome-title">APRESENTAÇÃO</h2>
                    <div class="welcome-text">
                        <p>É com grande satisfação que damos as <strong>boas-vindas</strong> a você que faz parte da equipe de <strong>Supervisores da Prática Profissional do Senac Paraná</strong>.</p>
                        <p>A prática profissional é um momento crucial na formação de nossos estudantes. E para que esse período seja um sucesso, contamos com a sua colaboração e dedicação.</p>
                        <p>Seu <strong>acompanhamento e orientações</strong> são essenciais para <strong>melhorar o processo educacional</strong> e <strong>fortalecer a parceria entre o Senac e a empresa</strong>, por meio de monitoramento contínuo, diálogo, observações, orientações e ações preventivas.</p>
                        <p>Agradecemos por fazer parte da nossa equipe! Conte conosco para qualquer dúvida.</p>
                        <p class="text-center" style="margin-top: 30px;"><img src="https://upload.wikimedia.org/wikipedia/commons/8/86/Senac_logo.svg" alt="Senac Logo" style="height: 30px; margin: 0 auto;"></p>
                    </div>
                </div>
            </div>

            <!-- ABA: DADOS (PAINEL BI INTEGRADO) -->
            <div id="view-dados" class="hidden-section w-full h-[800px]">
                <!-- Conteúdo do BI em Container Dedicado -->
                <div id="bi-app-container" class="flex flex-col h-full w-full bg-slate-50 border border-slate-200 rounded-xl overflow-hidden shadow-lg font-sans">
                    <!-- Header BI -->
                    <header class="bg-white border-b border-slate-200 flex-shrink-0 z-30 shadow-sm flex flex-col">
                        <div class="h-16 flex items-center justify-between px-8">
                            <div class="flex items-center gap-4">
                                <h1 class="font-bold text-sm text-slate-700 m-0">Painel de Supervisão</h1>
                                <p class="text-[10px] text-slate-400 font-medium uppercase tracking-wider m-0">Gestão de Aprendizagem</p>
                            </div>
                            <div class="flex items-center gap-6">
                                <div class="flex items-center gap-2">
                                    <input type="file" id="biFileInput" accept=".csv, .xlsx, .xlsm, .xls" class="hidden" onchange="processBiFile(this)">
                                    <button onclick="document.getElementById('biFileInput').click()" class="group flex items-center gap-2 bg-slate-50 hover:bg-blue-800 hover:text-white text-slate-600 px-4 py-2 rounded-xl border border-slate-200 transition-all shadow-sm">
                                        <i data-lucide="upload-cloud" class="w-4 h-4 text-orange-500 group-hover:text-white"></i>
                                        <span id="biBtnUploadText" class="text-xs font-bold uppercase m-0">Carregar Dados</span>
                                    </button>
                                    <div id="biLoadingSpinner" class="hidden"><div class="loader"></div></div>
                                </div>
                            </div>
                        </div>
                        <div class="flex px-8 bg-white gap-8 border-t border-slate-50">
                            <button onclick="switchBiTab('qualificacao')" id="biTabQualificacao" class="scope-btn active py-3 text-xs font-bold uppercase tracking-wide flex items-center gap-2"><i data-lucide="book-open" class="w-4 h-4"></i> Qualificação</button>
                            <button onclick="switchBiTab('tecnico')" id="biTabTecnico" class="scope-btn py-3 text-xs font-bold uppercase tracking-wide flex items-center gap-2"><i data-lucide="wrench" class="w-4 h-4"></i> Técnico</button>
                            <button onclick="switchBiTab('financeiro')" id="biTabFinanceiro" class="scope-btn py-3 text-xs font-bold uppercase tracking-wide flex items-center gap-2 text-emerald-600"><i data-lucide="dollar-sign" class="w-4 h-4"></i> Financeiro</button>
                        </div>
                    </header>

                    <div class="flex-1 overflow-hidden relative">
                        <!-- VIEW BI: DASHBOARD -->
                        <div id="biViewDashboard" class="flex h-full w-full">
                            <aside class="w-64 bg-white border-r border-slate-200 flex flex-col z-20 overflow-y-auto">
                                <div class="p-6 border-b border-slate-100 bg-slate-50/50">
                                    <h3 class="font-bold text-slate-700 mb-5 text-sm">Filtros Avançados</h3>
                                    <input type="text" id="biFilterSearch" onkeyup="applyBiFilters()" placeholder="Buscar..." class="w-full mb-5 p-3 bg-white border border-slate-200 rounded-xl text-sm outline-none focus:border-blue-800">
                                    <select id="biFilterRegiao" onchange="handleBiRegionChange()" class="w-full mb-4 p-3 bg-slate-50 border border-slate-200 rounded-xl text-sm outline-none cursor-pointer"><option value="">Todas as Regiões</option></select>
                                    <select id="biFilterCidade" onchange="applyBiFilters()" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl text-sm outline-none cursor-pointer"><option value="">Todas as Cidades</option></select>
                                </div>
                            </aside>
                            <main class="flex-1 flex flex-col overflow-hidden bg-slate-50/50 relative">
                                <div class="p-6 pb-2 grid grid-cols-12 gap-6 h-auto flex-shrink-0">
                                    <div class="col-span-12 lg:col-span-3 grid grid-cols-1 gap-4">
                                        <div class="card-bi p-5 border-l-4 border-l-blue-800"><p class="text-[11px] text-slate-400 font-bold uppercase mb-1">Total</p><h2 class="text-3xl font-extrabold text-slate-800 m-0" id="biKpiTotal">0</h2></div>
                                        <div class="card-bi p-5 border-l-4 border-l-red-500"><p class="text-[11px] text-red-400 font-bold uppercase mb-1">Atrasados</p><h2 class="text-3xl font-extrabold text-red-600 m-0" id="biKpiAtrasados">0</h2></div>
                                        <div class="card-bi p-5 border-l-4 border-l-emerald-500"><p class="text-[11px] text-emerald-500 font-bold uppercase mb-1">Em Dia</p><h2 class="text-3xl font-extrabold text-emerald-600 m-0" id="biKpiNoPrazo">0</h2></div>
                                    </div>
                                    <div class="col-span-12 md:col-span-4 lg:col-span-4 card-bi p-5 flex flex-col"><div class="flex-1 relative flex items-center justify-center"><canvas id="biChartStatus"></canvas></div></div>
                                    <div class="col-span-12 md:col-span-5 lg:col-span-5 card-bi p-5 flex flex-col"><div class="flex-1 relative"><canvas id="biChartRegiao"></canvas></div></div>
                                </div>
                                <div class="flex-1 px-6 pb-6 overflow-hidden flex flex-col">
                                    <div class="card-bi flex-1 flex flex-col overflow-hidden bg-white">
                                        <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-white rounded-t-2xl">
                                            <h3 class="font-bold text-slate-700 text-sm m-0">Detalhamento</h3>
                                            <button onclick="exportBiReport()" class="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg text-xs font-bold"><i data-lucide="download" class="w-4 h-4"></i> Excel</button>
                                        </div>
                                        <div class="flex-1 overflow-auto"><table class="w-full text-left border-collapse"><tbody id="biTableBody" class="divide-y divide-slate-100 text-sm"></tbody></table></div>
                                    </div>
                                </div>
                            </main>
                        </div>
                        <!-- VIEW BI: FINANCEIRO -->
                        <div id="biViewFinanceiro" class="hidden h-full w-full bg-slate-50/50 flex-col overflow-auto p-8">
                             <div class="max-w-7xl mx-auto w-full">
                                <h2 class="text-2xl font-bold text-slate-800 mb-8 mt-0">Gestão Orçamentária</h2>
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                                    <div class="card-bi p-5 border-l-4 border-l-emerald-500"><label class="text-xs font-bold text-slate-400 uppercase">Orçamento (R$)</label><input type="number" id="biInputBudget" value="5000" class="money-input text-xl" oninput="updateBiFinancials()"></div>
                                    <div class="card-bi p-5 border-l-4 border-l-blue-500"><label class="text-xs font-bold text-slate-400 uppercase">Custo/Visita (R$)</label><input type="number" id="biInputCost" value="85.50" class="money-input text-xl" oninput="updateBiFinancials()"></div>
                                    <div class="card-bi p-5"><p class="text-[10px] text-slate-400 font-bold uppercase mb-1">Pendentes</p><h3 class="text-3xl font-extrabold text-slate-700 m-0" id="biFinPendingVisits">0</h3></div>
                                    <div class="card-bi p-5 bg-slate-800 text-white border-none"><p class="text-[10px] text-slate-400 font-bold uppercase mb-1">Custo Projetado</p><h3 class="text-3xl font-extrabold text-white m-0" id="biFinProjectedCost">R$ 0,00</h3></div>
                                </div>
                                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                    <div class="col-span-1 card-bi p-6 text-center"><p class="text-xs font-bold text-slate-400 uppercase mb-2">Saldo Final</p><h2 class="text-4xl font-extrabold mb-2 m-0" id="biFinBalance">R$ 0,00</h2><div id="biFinStatusBadge" class="px-4 py-1 rounded-full text-xs font-bold uppercase bg-slate-100 text-slate-500 inline-block">...</div></div>
                                    <div class="col-span-2 card-bi p-5"><div class="h-64 w-full relative"><canvas id="biChartFinance"></canvas></div></div>
                                </div>
                             </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ABA: FLUXOGRAMA (Original Intacto) -->
            <div id="view-fluxograma" class="timeline-container timeline-line hidden-section">
                
                <a href="https://www.planalto.gov.br/ccivil_03/_Ato2023-2026/2023/Decreto/D11479.htm" target="_blank" class="timeline-art art-1">
                    <div class="art-content">
                        <div class="art-title">DECRETO Nº 11.479,</div>
                        <div class="art-subtitle">DE 6 DE ABRIL DE 2023</div>
                        <div class="art-desc">Altera o Decreto nº 9.579, de 22 de novembro de 2018, para dispor sobre o direito à profissionalização de adolescentes e jovens por meio de programas de aprendizagem profissional.</div>
                    </div>
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/bf/Coat_of_arms_of_Brazil.svg" class="art-coat" alt="Brasão">
                </a>
                
                <div class="phase-badge"><span class="phase-blue"><span>Fase 1: Acesso & Planejamento</span></span></div>

                <!-- ETAPA 1 -->
                <div class="timeline-step" style="display: flex; flex-direction: column; align-items: center; margin-bottom: 50px;">
                    <div class="step-number" style="margin-bottom: 20px;">1</div>
                    <div class="step-content border-left-orange" style="width: 55%; float: none;" onclick="openStepInfo(1)">
                        <h3 style="display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-map-marker-alt" style="color: var(--senac-orange);"></i> Selecione a sua região
                        </h3>
                        <p style="margin-bottom: 15px;">Escolha a unidade abaixo para acessar sua planilha de planejamento no SharePoint.</p>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;" onclick="event.stopPropagation()">
                            <select id="fluxo-region-select" class="region-select" style="margin-bottom: 0; flex-grow: 1;">
                                <option value="" disabled selected>-- Selecione --</option>
                                <option value="campo_mourao">Campo Mourão</option>
                                <option value="francisco_beltrao">Francisco Beltrão</option>
                                <option value="guarapuava">Guarapuava</option>
                                <option value="umuarama">Umuarama</option>
                            </select>
                            <button onclick="accessRegionSpreadsheet()" class="btn-primary" style="width: auto; padding: 10px 20px; font-size: 0.9rem;">
                                Acessar <i class="fas fa-external-link-alt" style="margin-left: 5px;"></i>
                            </button>
                        </div>
                        <p id="region-access-msg" style="font-size: 0.75rem; color: #666; margin-top: 8px; font-style: italic; display: none;"></p>
                    </div>
                </div>

                <!-- ETAPA 2 -->
                <div class="timeline-step">
                    <div class="empty-space"></div>
                    <div class="step-number bg-orange">2</div>
                    <div class="step-content border-right-blue" onclick="openStepInfo(2)">
                        <h3><i class="fas fa-desktop"></i> Execução no Desktop</h3>
                        <p>Ao acessar a planilha da sua região, selecione a opção para executá-la no desktop. Dessa forma, as macros serão ativadas e as abas de planejamento funcionarão de maneira automatizada.</p>
                    </div>
                </div>

                <!-- ETAPA 3 -->
                <div class="timeline-step">
                    <div class="step-content border-left-orange" onclick="openStepInfo(3)">
                        <h3><i class="fas fa-cloud-download-alt"></i> Download de Documentos</h3>
                        <p style="margin-bottom: 10px;">Selecione o documento necessário e clique em baixar.</p>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap;" onclick="event.stopPropagation()">
                            <select id="fluxo-doc-select" class="region-select" style="margin-bottom: 0; flex-grow: 1; font-size: 0.85rem; padding: 8px;">
                                <option value="" disabled selected>-- Escolha um arquivo --</option>
                                <option value="manual_simplificado.pdf">Manual simplificado</option>
                                <option value="guia_preenchimento.pdf">Guia de Preenchimento</option>
                                <option value="instrucao_completa.pdf">Instrução Completa</option>
                                <option value="lista_tip.pdf">Lista TIP (Horizontal)</option>
                                <option value="os_veiculo.pdf">OS - Veículo Próprio</option>
                                <option value="formulario_supervisao.docx">Formulário Supervisão 2025</option>
                                <option value="ata_programa.docx">ATA - Programa Aprendizagem</option>
                                <option value="capa_controle.pdf">Capa de Controle</option>
                            </select>
                            <button onclick="downloadSelectedDoc()" class="btn-primary" style="width: auto; padding: 8px 15px; font-size: 0.85rem; background-color: var(--senac-blue);">
                                Baixar
                            </button>
                        </div>
                    </div>
                    <div class="step-number">3</div>
                    <div class="empty-space"></div>
                </div>

                <!-- ETAPA 4 -->
                <div class="timeline-step">
                    <div class="empty-space"></div>
                    <div class="step-number bg-orange">4</div>
                    <div class="step-content border-right-blue" onclick="openStepInfo(4)"><h3>Planilha de Planejamento</h3><p>Acesse “Planilha de planejamento – região”.</p></div>
                </div>
                
                <!-- ETAPA 5 -->
                <div class="timeline-step">
                    <div class="step-content border-left-orange" onclick="openStepInfo(5)"><h3>Configuração da Planilha</h3><p>Leia a aba “Avisos” e renomeie as abas.</p></div>
                    <div class="step-number">5</div><div class="empty-space"></div>
                </div>

                <div class="phase-badge"><span class="phase-orange"><span>Fase 2: Logística</span></span></div>
                
                <a href="https://www.planalto.gov.br/ccivil_03/LEIS/L10097.htm" target="_blank" class="timeline-art art-2">
                    <div class="art-content">
                        <div class="art-title">Lei nº 10.097</div>
                        <div class="art-subtitle">de 19 de dezembro de 2000</div>
                        <div class="art-desc">Altera dispositivos da Consolidação das Leis do Trabalho – CLT, aprovada pelo Decreto-Lei nº 5.452, de 1º de maio de 1943.</div>
                    </div>
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/bf/Coat_of_arms_of_Brazil.svg" class="art-coat" alt="Brasão">
                </a>
                
                <!-- ETAPA 6 -->
                <div class="timeline-step">
                    <div class="empty-space"></div>
                    <div class="step-number bg-orange">6</div>
                    <div class="step-content border-right-blue" onclick="openStepInfo(6)"><h3>Montar Logística</h3><p>Montar logística na aba de planejamento.</p></div>
                </div>
                <!-- ETAPA 7 -->
                <div class="timeline-step">
                    <div class="step-content border-left-orange" onclick="openStepInfo(7)"><h3>Aprovação</h3><p>Avisar ao Polo-PR e aguardar.</p></div>
                    <div class="step-number">7</div><div class="empty-space"></div>
                </div>
                <!-- ETAPA 8 -->
                <div class="timeline-step">
                    <div class="empty-space"></div>
                    <div class="step-number bg-orange">8</div>
                    <div class="step-content border-right-blue" onclick="openStepInfo(8)"><h3>Abertura de Viagem</h3><p>Pedido para abertura de viagem.</p></div>
                </div>
                <!-- ETAPA 9 -->
                <div class="timeline-step">
                    <div class="step-content border-left-orange" onclick="openStepInfo(9)"><h3>Confirmação</h3><p>Enviar e-mails aos supervisores.</p></div>
                    <div class="step-number">9</div><div class="empty-space"></div>
                </div>

                <div class="phase-badge"><span class="phase-green"><span>Fase 3: Execução</span></span></div>

                <!-- ETAPA 10 -->
                <div class="timeline-step">
                    <div class="empty-space"></div>
                    <div class="step-number">10</div>
                    <div class="step-content border-right-blue" onclick="openStepInfo(10)">
                        <h3>Baixar Formulário e/ou ATA</h3>
                        <p>Acesse a aba <strong>"Documentos"</strong> ou baixe clicando aqui:</p>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px;" onclick="event.stopPropagation()">
                            <select id="step10-doc-select" class="region-select" style="margin-bottom: 0; flex-grow: 1; font-size: 0.85rem; padding: 8px;">
                                <option value="" disabled selected>-- Selecione --</option>
                                <option value="formulario_supervisao.docx">Formulário Supervisão 2025</option>
                                <option value="ata_programa.docx">ATA - Programa Aprendizagem</option>
                            </select>
                            <button onclick="downloadStep10Doc()" class="btn-primary" style="width: auto; padding: 8px 15px; font-size: 0.85rem; background-color: var(--senac-blue);">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ETAPA 11 -->
                <div class="timeline-step">
                    <div class="step-content border-left-orange" onclick="openStepInfo(11)"><h3>Preenchimento</h3><p>Preencher cabeçalho do formulário.</p></div>
                    <div class="step-number bg-orange">11</div><div class="empty-space"></div>
                </div>
                
                <a href="https://www.gov.br/trabalho-e-emprego/pt-br/assuntos/aprendizagem-profissional" target="_blank" class="timeline-art art-3">
                    <div class="art-content">
                        <div class="art-title" style="font-size: 1.2rem;">PORTARIA MTE Nº 3.872,</div>
                        <div class="art-subtitle" style="font-size: 0.9rem;">DE 21 DE DEZEMBRO DE 2023</div>
                        <div class="art-desc">Dispõe sobre a aprendizagem profissional, o Cadastro Nacional de Aprendizagem Profissional e o Catálogo Nacional da Aprendizagem Profissional.</div>
                    </div>
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/bf/Coat_of_arms_of_Brazil.svg" class="art-coat" alt="Brasão">
                </a>

                 <a href="https://www.planalto.gov.br/ccivil_03/_ato2007-2010/2008/decreto/d6481.htm" target="_blank" class="timeline-art art-4">
                    <div class="art-content">
                        <div class="art-title" style="font-size: 1.2rem;">LISTA TIP</div>
                        <div class="art-subtitle" style="font-size: 0.9rem;">PIORES FORMAS DE TRABALHO INFANTIL</div>
                        <div class="art-desc">Decreto nº 3.597, de 12 de setembro de 2000.</div>
                    </div>
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/bf/Coat_of_arms_of_Brazil.svg" class="art-coat" alt="Brasão">
                </a>
                
                <!-- ETAPA 12 -->
                <div class="timeline-step">
                    <div class="empty-space"></div>
                    <div class="step-number">12</div>
                    <div class="step-content border-right-blue" onclick="openStepInfo(12)">
                        <h3>Relatório de Desempenho</h3>
                        <p style="margin-bottom: 10px;">Selecione a região para consultar o relatório:</p>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: flex-end;" onclick="event.stopPropagation()">
                             <select id="relatorio-region-select" class="region-select" style="margin-bottom: 0; flex-grow: 1; font-size: 0.85rem; padding: 8px;">
                                <option value="" disabled selected>-- Selecione --</option>
                                <option value="campo_mourao">Campo Mourão</option>
                                <option value="francisco_beltrao">Francisco Beltrão</option>
                                <option value="guarapuava">Guarapuava</option>
                                <option value="umuarama">Umuarama</option>
                            </select>
                            <button onclick="accessPerformanceReport()" class="btn-primary" style="width: auto; padding: 8px 15px; font-size: 0.85rem; background-color: var(--senac-blue);">
                                Acessar
                            </button>
                        </div>
                         <p id="relatorio-access-msg" style="font-size: 0.75rem; color: #666; margin-top: 8px; font-style: italic; display: none; text-align: right;"></p>
                    </div>
                </div>

                <!-- ETAPA 13 -->
                <div class="timeline-step">
                    <div class="step-content border-left-orange" onclick="openStepInfo(13)"><h3>A Entrevista</h3><p>Entrevista com supervisor e estudante.</p></div>
                    <div class="step-number bg-orange">13</div><div class="empty-space"></div>
                </div>

                <div class="phase-badge"><span class="phase-green"><span>Fase 4: Finalização</span></span></div>
                
                <!-- ETAPA 14 -->
                <div class="timeline-step">
                    <div class="empty-space"></div>
                    <div class="step-number">14</div>
                    <div class="step-content border-right-green" onclick="openStepInfo(14)">
                        <h3>Digitalizar + Enviar</h3>
                        <p>Digitalizar (Turma + Nome). Enviar no AVA.</p>
                        <button onclick="openUploadModal(); event.stopPropagation();" class="link-btn" style="color: var(--senac-green); background-color: #dcfce7; margin-top: 10px; width: 100%; justify-content: center;">
                            <i class="fas fa-upload" style="margin-right: 5px;"></i> Enviar Arquivos
                        </button>
                    </div>
                </div>
                
                <!-- ETAPA 15 -->
                <div class="timeline-step">
                    <div class="step-content border-left-green" onclick="openStepInfo(15)"><h3>Registro na Planilha</h3><p>Preencher dados pós-visita na planilha.</p></div>
                    <div class="step-number bg-orange">15</div><div class="empty-space"></div>
                </div>

                <!-- ETAPA 16 -->
                <div class="timeline-step">
                    <div class="empty-space"></div>
                    <div class="step-number bg-green">16</div>
                    <div class="step-content border-right-green" onclick="openStepInfo(16)">
                        <h3>Informações para Rateio</h3>
                        <p>Atualizar informações de visitas.</p>
                    </div>
                </div>

                <!-- ETAPA 17 -->
                <div class="timeline-step">
                    <div class="step-content border-left-green" onclick="openStepInfo(17)">
                        <h3>Envio Malote</h3>
                        <p>Envio dos documentos via Malote</p>
                    </div>
                    <div class="step-number bg-orange">17</div>
                    <div class="empty-space"></div>
                </div>

                <!-- ETAPA 18 -->
                <div class="timeline-step">
                    <div class="empty-space"></div>
                    <div class="step-number bg-green">18</div>
                    <div class="step-content border-right-orange" style="background-color: #eff6ff;" onclick="openStepInfo(18)">
                        <h3>Conclusão</h3>
                        <p>Sinalizar ao Polo-PR.</p>
                        <p style="color: var(--senac-green); font-weight: bold; font-size: 0.75rem; text-transform: uppercase; margin-top: 5px;">Processo Finalizado</p>
                    </div>
                </div>
            </div>

            <!-- ABA: DOCUMENTOS -->
            <div id="view-documentos" class="hidden-section">
                <div class="search-bar-container">
                    <h2 style="color: var(--senac-blue); font-size: 1.5rem; font-weight: bold;">Central de Documentos</h2>
                    <div class="search-input-wrapper">
                        <input type="text" id="doc-search" onkeyup="filterDocuments()" class="search-input" placeholder="Buscar arquivo...">
                    </div>
                </div>
                
                <div class="doc-section-title" style="margin-bottom: 20px; font-weight: bold; color: var(--senac-blue);"><i class="fas fa-book-reader" style="color: var(--senac-blue); margin-right: 10px;"></i> Guias e Manuais</div>
                <div class="grid-docs">
                    <div class="doc-card">
                        <div class="doc-header">
                            <div class="icon-box ib-blue"><i class="fas fa-book"></i></div>
                            <div class="doc-info">
                                <h4>Manual simplificado</h4><p>Diretrizes gerais.</p>
                                <a href="manual_simplificado.pdf" target="_blank" class="download-link">Baixar Arquivo <i class="fas fa-download" style="margin-left: 5px;"></i></a>
                            </div>
                        </div>
                    </div>
                    <div class="doc-card">
                        <div class="doc-header">
                            <div class="icon-box ib-blue"><i class="fas fa-list-check"></i></div>
                            <div class="doc-info">
                                <h4>Guia de Preenchimento</h4><p>Passo a passo rápido.</p>
                                <a href="guia_preenchimento.pdf" target="_blank" class="download-link">Baixar Arquivo <i class="fas fa-download" style="margin-left: 5px;"></i></a>
                            </div>
                        </div>
                    </div>
                    <div class="doc-card">
                        <div class="doc-header">
                            <div class="icon-box ib-blue"><i class="fas fa-info-circle"></i></div>
                            <div class="doc-info">
                                <h4>Instrução Completa</h4><p>Detalhes técnicos.</p>
                                <a href="instrucao_completa.pdf" target="_blank" class="download-link">Baixar Arquivo <i class="fas fa-download" style="margin-left: 5px;"></i></a>
                            </div>
                        </div>
                    </div>
                    <div class="doc-card">
                        <div class="doc-header">
                            <div class="icon-box ib-blue"><i class="fas fa-clipboard-list"></i></div>
                            <div class="doc-info">
                                <h4>Lista TIP (Horizontal)</h4><p>Referência atualizada.</p>
                                <a href="lista_tip.pdf" target="_blank" class="download-link">Baixar Arquivo <i class="fas fa-download" style="margin-left: 5px;"></i></a>
                            </div>
                        </div>
                    </div>
                     <div class="doc-card">
                        <div class="doc-header">
                            <div class="icon-box ib-blue"><i class="fas fa-car"></i></div>
                            <div class="doc-info">
                                <h4>OS - Veículo Próprio</h4><p>Ordem de serviço.</p>
                                <a href="os_veiculo.pdf" target="_blank" class="download-link">Baixar Arquivo <i class="fas fa-download" style="margin-left: 5px;"></i></a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="doc-section-title" style="margin-bottom: 20px; font-weight: bold; color: var(--senac-orange);"><i class="fas fa-file-signature" style="color: var(--senac-orange); margin-right: 10px;"></i> Formulários e Registros</div>
                <div class="grid-docs">
                    <div class="doc-card" style="border-left: 4px solid var(--senac-orange);">
                        <div class="doc-header">
                            <div class="icon-box ib-orange"><i class="fas fa-file-word"></i></div>
                            <div class="doc-info">
                                <h4>Formulário Supervisão 2025</h4><p>Obrigatório.</p>
                                <a href="formulario_supervisao.docx" target="_blank" class="download-link text-orange-hover">Baixar Arquivo <i class="fas fa-download" style="margin-left: 5px;"></i></a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="doc-card" style="border-left: 4px solid var(--senac-orange);">
                        <div class="doc-header">
                            <div class="icon-box ib-orange"><i class="fas fa-file-word"></i></div>
                            <div class="doc-info">
                                <h4>ATA - Programa Aprendizagem</h4><p>Inclui manual.</p>
                                <a href="ata_programa.docx" target="_blank" class="download-link text-orange-hover">Baixar Arquivo <i class="fas fa-download" style="margin-left: 5px;"></i></a>
                            </div>
                        </div>
                    </div>

                    <div class="doc-card" style="border-left: 4px solid var(--senac-orange);">
                        <div class="doc-header">
                            <div class="icon-box ib-orange"><i class="fas fa-folder"></i></div>
                            <div class="doc-info">
                                <h4>Capa de Controle</h4><p>Organização física.</p>
                                <a href="capa_controle.pdf" target="_blank" class="download-link text-orange-hover">Baixar Arquivo <i class="fas fa-download" style="margin-left: 5px;"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ABA: EQUIPE -->
            <div id="view-equipe" class="hidden-section">
                <div style="background: white; border: 1px solid #ddd; border-radius: 8px; padding: 30px; margin-bottom: 40px;">
                    <h2 style="color: var(--senac-blue); border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 25px;">Equipe Pedagógica</h2>
                    <div class="grid-docs">
                        <div class="member-card">
                            <div class="avatar">AP</div>
                            <div class="member-info">
                                <h3>Ana Paula</h3><div class="member-role">Analista Pleno</div>
                                <div class="member-contact">
                                    <a href="mailto:anapaula.duarte@pr.senac.br"><i class="fas fa-envelope"></i> anapaula.duarte@pr.senac.br</a>
                                    <a href="https://wa.me/554133145814" target="_blank"><i class="fab fa-whatsapp" style="color: #25D366;"></i> (41) 3314-5814</a>
                                </div>
                            </div>
                        </div>
                        <div class="member-card">
                            <div class="avatar">B</div>
                            <div class="member-info">
                                <h3>Bianca Aresta</h3><div class="member-role">Analista Pedagógica</div>
                                <div class="member-contact">
                                    <a href="mailto:bianca.aresta@pr.senac.br"><i class="fas fa-envelope"></i> bianca.aresta@pr.senac.br</a>
                                    <a href="https://wa.me/554133145875" target="_blank"><i class="fab fa-whatsapp" style="color: #25D366;"></i> (41) 3314-5875</a>
                                </div>
                            </div>
                        </div>
                        <div class="member-card">
                            <div class="avatar">B</div>
                            <div class="member-info">
                                <h3>Bruna Cunha</h3><div class="member-role">Analista Pedagógica</div>
                                <div class="member-contact">
                                    <a href="mailto:bruna.cunha@pr.senac.br"><i class="fas fa-envelope"></i> bruna.cunha@pr.senac.br</a>
                                    <a href="https://wa.me/554133145816" target="_blank"><i class="fab fa-whatsapp" style="color: #25D366;"></i> (41) 3314-5816</a>
                                </div>
                            </div>
                        </div>
                        <div class="member-card">
                            <div class="avatar">M</div>
                            <div class="member-info">
                                <h3>Mariana Mello</h3><div class="member-role">Analista Pedagógica</div>
                                <div class="member-contact">
                                    <a href="mailto:mariana.mello@pr.senac.br"><i class="fas fa-envelope"></i> mariana.mello@pr.senac.br</a>
                                    <a href="https://wa.me/554133145858" target="_blank"><i class="fab fa-whatsapp" style="color: #25D366;"></i> (41) 3314-5858</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="background: white; border: 1px solid #ddd; border-radius: 8px; padding: 30px;">
                    <h2 style="color: var(--senac-blue); border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 25px;">Equipe Administrativa Pedagógica</h2>
                    <div class="grid-docs">
                        <div class="member-card">
                            <div class="avatar avatar-gray">C</div>
                            <div class="member-info">
                                <h3>Cristina Maciel</h3><div class="member-role" style="color: #6b7280;">Assistente Administrativo</div>
                                <div class="member-contact">
                                    <a href="mailto:cristina.maciel@pr.senac.br"><i class="fas fa-envelope"></i> cristina.maciel@pr.senac.br</a>
                                    <a href="https://wa.me/554133145840" target="_blank"><i class="fab fa-whatsapp" style="color: #25D366;"></i> (41) 3314-5840</a>
                                </div>
                            </div>
                        </div>
                        <div class="member-card">
                            <div class="avatar avatar-gray">L</div>
                            <div class="member-info">
                                <h3>Leo Santos</h3><div class="member-role" style="color: #6b7280;">Assistente Administrativo</div>
                                <div class="member-contact">
                                    <a href="mailto:leo.santos@pr.senac.br"><i class="fas fa-envelope"></i> leo.santos@pr.senac.br</a>
                                    <a href="https://wa.me/554133145818" target="_blank"><i class="fab fa-whatsapp" style="color: #25D366;"></i> (41) 3314-5818</a>
                                </div>
                            </div>
                        </div>
                        <div class="member-card">
                            <div class="avatar avatar-gray">N</div>
                            <div class="member-info">
                                <h3>Nathalia</h3><div class="member-role" style="color: #6b7280;">Auxiliar Administrativa</div>
                                <div class="member-contact">
                                    <a href="mailto:nathalia@pr.senac.br"><i class="fas fa-envelope"></i> nathalia@pr.senac.br</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <div class="container footer-grid">
                <div class="footer-col">
                    <h4>Senac PR</h4><p>Serviço Nacional de Aprendizagem Comercial</p><p>Portal interno do Supervisor da Prática Profissional.</p>
                </div>
                <div class="footer-col">
                    <h4>Links Rápidos</h4>
                    <ul>
                        <li><a href="mailto:cristina.maciel@pr.senac.br">Canal do Supervisor <i class="fas fa-envelope"></i></a></li>
                        <li><a href="https://wa.me/554133145817" target="_blank">Suporte ao Supervisor <i class="fab fa-whatsapp"></i></a></li>
                        <li><a href="https://intranet.pr.senac.br/ar/acm/index.asp?" target="_blank">Portal do Colaborador</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Contato</h4><p><a href="mailto:michel.farias@pr.senac.br"><i class="fas fa-envelope"></i> michel.farias@pr.senac.br</a></p><p><a href="https://wa.me/554133145817" target="_blank"><i class="fab fa-whatsapp"></i> (41) 3314-5817</a></p>
                </div>
            </div>
            <div class="container footer-bottom">&copy; 2025 Senac PR. Todos os direitos reservados.</div>
        </footer>
    </div>

    <!-- JANELA/MODAL DE UPLOAD -->
    <div id="upload-modal" class="modal-overlay">
        <div class="modal-box">
            <button class="close-modal-btn" onclick="closeUploadModal()">&times;</button>
            <h2 style="color: var(--senac-blue); margin-bottom: 20px; font-weight: 900;">Enviar Arquivos</h2>
            
            <div class="warning-box">
                <i class="fas fa-exclamation-triangle" style="font-size: 1.5rem; margin-top: 2px;"></i>
                <p>Lembre-se de renomear o arquivo com o <strong>número da turma + nome completo do jovem</strong>, para facilitar a identificação e arquivamento do documento.</p>
            </div>
            
            <label for="region-select" style="display: block; text-align: left; font-weight: bold; color: var(--senac-blue); margin-bottom: 5px;">Selecione sua Região:</label>
            <select id="region-select" class="region-select">
                <option value="">-- Escolha uma cidade --</option>
                <option value="campo_mourao">Campo Mourão</option>
                <option value="francisco_beltrao">Francisco Beltrão</option>
                <option value="guarapuava">Guarapuava</option>
                <option value="umuarama">Umuarama</option>
            </select>

            <div class="upload-area">
                <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: #cbd5e1; margin-bottom: 10px;"></i>
                <p style="margin-bottom: 5px; color: #374151; font-weight: bold;">Upload Seguro</p>
                <p style="margin-bottom: 15px; font-size: 0.9rem; color: #6b7280;">
                    Ao clicar no botão abaixo, você será redirecionado para a pasta segura da sua região.
                </p>
            </div>

            <button class="btn-primary" onclick="openUploadForm()" style="margin-top: 10px;">
                <i class="fas fa-external-link-alt"></i> Acessar Pasta de Envio
            </button>
        </div>
    </div>

    <!-- JANELA/MODAL PARA DETALHES DA ETAPA (NOVO) -->
    <div id="step-detail-modal" class="modal-overlay">
        <div class="modal-glass">
            <button class="close-modal-btn" onclick="closeStepInfo()">&times;</button>
            <div class="glass-header">
                <h2 id="step-modal-title" class="glass-title">Título da Etapa</h2>
                <div id="step-modal-subtitle" class="glass-subtitle">Fase do Processo</div>
            </div>
            <div id="step-modal-content" class="glass-content">
                <!-- Conteúdo inserido via JS -->
            </div>
        </div>
    </div>

    <script>
        const loginScreen = document.getElementById('login-screen');
        const siteContent = document.getElementById('site-content');
        const body = document.getElementById('main-body');
        const passwordInput = document.getElementById('password-input');
        const errorMsg = document.getElementById('error-msg');
        const SENHA_CORRETA = "senac2026";

        function checkPassword() {
            if (passwordInput.value.toUpperCase() === SENHA_CORRETA.toUpperCase()) {
                localStorage.setItem('senac_auth', 'true');
                showContent();
            } else {
                errorMsg.style.display = 'flex';
                passwordInput.classList.add('error');
                passwordInput.value = '';
                passwordInput.focus();
            }
        }
        passwordInput.addEventListener('input', () => { errorMsg.style.display = 'none'; passwordInput.classList.remove('error'); });

        function showContent() {
            loginScreen.style.display = 'none';
            siteContent.classList.remove('hidden-section');
            body.classList.remove('locked');
            switchTab('boas-vindas');
            // Inicializa BI ao entrar
            initBiUsers();
        }

        function logout() {
            localStorage.removeItem('senac_auth');
            location.reload();
        }

        document.addEventListener("DOMContentLoaded", function() {
            if (localStorage.getItem('senac_auth') === 'true') { showContent(); }
            else { passwordInput.focus(); }
            if (typeof lucide !== 'undefined') lucide.createIcons();
        });

        function switchTab(tabName) {
            ['boas-vindas', 'fluxograma', 'dados', 'documentos', 'equipe'].forEach(tab => {
                document.getElementById('view-' + tab).classList.add('hidden-section');
                document.getElementById('btn-' + tab).classList.remove('active');
            });
            document.getElementById('view-' + tabName).classList.remove('hidden-section');
            document.getElementById('btn-' + tabName).classList.add('active');
            
            const titles = {
                'boas-vindas': ["Bem-Vindo(a) Supervisor(a)!", "Portal de apoio para a supervisão da Prática Profissional do Senac PR."],
                'fluxograma': ["Fluxo de Monitoramento", "Guia oficial para supervisão de práticas profissionais - Senac PR"],
                'dados': ["Painel de Dados", "Monitoramento em tempo real dos indicadores de aprendizagem."],
                'documentos': ["Central de Documentos", "Baixe todos os arquivos necessários."],
                'equipe': ["Equipe Técnica", "Contatos e responsáveis pedagógicos."]
            };
            document.getElementById('hero-title').innerText = titles[tabName][0];
            document.getElementById('hero-subtitle').innerText = titles[tabName][1];
            document.getElementById('mobile-menu').style.display = 'none';

            // Se for aba Dados, renderizar gráficos BI
            if(tabName === 'dados' && biFilteredData.length > 0 && !biChartStatusInstance) {
                setTimeout(updateBiDashboard, 100);
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
        }

        function filterDocuments() {
            let filter = document.getElementById('doc-search').value.toUpperCase();
            let cards = document.getElementsByClassName('doc-card');
            for (let i = 0; i < cards.length; i++) {
                let h4 = cards[i].getElementsByTagName("h4")[0];
                if (h4) {
                    cards[i].style.display = (h4.textContent.toUpperCase().indexOf(filter) > -1) ? "" : "none";
                }
            }
        }

        // --- FUNÇÕES DE MODAL DE UPLOAD ---
        function openUploadModal() { document.getElementById('upload-modal').classList.add('active'); }
        function closeUploadModal() { document.getElementById('upload-modal').classList.remove('active'); }
        
        function openUploadForm() {
            const linksPorRegiao = {
                'campo_mourao': 'https://senacpr-my.sharepoint.com/:f:/g/personal/tutoria_aprendizagem_pr_senac_br/IgCtlUZaS1ViSqqd-LfwfAhUASl6_V1-GxHrAnWGuUj2BXo',
                'francisco_beltrao': 'https://senacpr-my.sharepoint.com/:f:/g/personal/tutoria_aprendizagem_pr_senac_br/IgA7auw4MZNYSbw2kUanBtuHAav-cBusC4wCelholjwhFKA',
                'guarapuava': 'https://senacpr-my.sharepoint.com/:f:/g/personal/tutoria_aprendizagem_pr_senac_br/IgB1-VVBjcpATae_CCqK4Bu9AdXZ09snZQ9uL2ZQKhnK_kw',
                'umuarama': 'https://senacpr-my.sharepoint.com/:f:/g/personal/tutoria_aprendizagem_pr_senac_br/IgCbQHxgU9rESphEFu8dbcXLAUB3tXkeaiwl972MD1LNgac'
            };
            const regiao = document.getElementById('region-select').value;
            if (regiao && linksPorRegiao[regiao]) { window.open(linksPorRegiao[regiao], '_blank'); closeUploadModal(); }
            else { alert("Selecione uma região válida."); }
        }

        // --- ACESSAR PLANILHAS (Etapa 1) ---
        function accessRegionSpreadsheet() {
            const regionSelect = document.getElementById('fluxo-region-select');
            const region = regionSelect.value;
            const msg = document.getElementById('region-access-msg');

            const spreadsheets = {
                'campo_mourao': {
                    url: 'https://senacpr-my.sharepoint.com/personal/michel_farias_pr_senac_br/_layouts/15/Doc.aspx?sourcedoc={4d4d9d28-18e8-43ad-8031-72c6b13be916}&action=embedview&wdAllowInteractivity=False&wdInConfigurator=True&wdInConfigurator=True&edaebf=rslc0',
                    contact: 'Luciano Ramos (luciano.ramos@docente.pr.senac.br)'
                },
                'francisco_beltrao': {
                    url: 'https://senacpr-my.sharepoint.com/personal/michel_farias_pr_senac_br/_layouts/15/Doc.aspx?sourcedoc={25529649-c755-45b7-a875-a23707ffd7bb}&action=embedview&wdInConfigurator=True&wdInConfigurator=True&edaebf=rslc0',
                    contact: 'Samoel Pitz (samoel.pitz@docente.pr.senac.br)'
                },
                'guarapuava': {
                    url: 'https://senacpr-my.sharepoint.com/personal/michel_farias_pr_senac_br/_layouts/15/Doc.aspx?sourcedoc={5d1d386c-f1cf-41d2-8997-1ac56b37f657}&action=embedview&wdInConfigurator=True&wdInConfigurator=True&edaebf=rslc0',
                    contact: 'Michelly Gronkoski (michelly.gronkoski@docente.pr.senac.br)'
                },
                'umuarama': {
                    url: 'https://senacpr-my.sharepoint.com/', 
                    contact: 'Responsável Regional'
                }
            };

            if (region && spreadsheets[region]) {
                const data = spreadsheets[region];
                msg.style.display = 'block';
                msg.innerHTML = `Gestor do acesso: ${data.contact}`;
                setTimeout(() => {
                    window.open(data.url, '_blank');
                }, 800);
            } else {
                alert("Por favor, selecione uma região válida.");
            }
        }

        // --- ACESSAR RELATÓRIO (Etapa 12) ---
        function accessPerformanceReport() {
            const regionSelect = document.getElementById('relatorio-region-select');
            const region = regionSelect.value;
            const msg = document.getElementById('relatorio-access-msg');

            const reports = {
                'campo_mourao': {
                    url: 'https://senacpr-my.sharepoint.com/personal/michel_farias_pr_senac_br/_layouts/15/Doc.aspx?sourcedoc={ca8dbe4f-36ab-44c3-98cd-ff5cc7844e41}&action=embedview&wdAllowInteractivity=False&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True&edaebf=rslc0',
                    contact: 'Luciano Ramos (luciano.ramos@docente.pr.senac.br)'
                },
                'francisco_beltrao': {
                    url: 'https://senacpr-my.sharepoint.com/personal/michel_farias_pr_senac_br/_layouts/15/Doc.aspx?sourcedoc={f3c19804-d04d-4dda-bdec-2f1ef0046129}&action=embedview&wdAllowInteractivity=False&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True&edaebf=rslc0',
                    contact: 'Samoel Pitz (samoel.pitz@docente.pr.senac.br)'
                },
                'guarapuava': {
                    url: 'https://senacpr-my.sharepoint.com/personal/michel_farias_pr_senac_br/_layouts/15/Doc.aspx?sourcedoc={7ce26397-6f96-4462-9771-d3c65a1914ac}&action=embedview&wdAllowInteractivity=False&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True&edaebf=rslc0',
                    contact: 'Michelly Gronkoski (michelly.gronkoski@docente.pr.senac.br)'
                },
                'umuarama': {
                    url: 'https://senacpr-my.sharepoint.com/', 
                    contact: 'Responsável Regional'
                }
            };

            if (region && reports[region]) {
                const data = reports[region];
                msg.style.display = 'block';
                msg.innerHTML = `Gestor do acesso: ${data.contact}`;
                setTimeout(() => {
                    window.open(data.url, '_blank');
                }, 800);
            } else {
                alert("Por favor, selecione uma região para ver o relatório.");
            }
        }

        // --- DOWNLOAD DOCUMENTOS (Etapa 3) ---
        function downloadSelectedDoc() {
            const docSelect = document.getElementById('fluxo-doc-select');
            const selectedDoc = docSelect.value;
            if (selectedDoc) {
                const link = document.createElement('a');
                link.href = selectedDoc;
                link.target = '_blank';
                link.download = selectedDoc.split('/').pop();
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert("Por favor, selecione um documento para baixar.");
            }
        }

        // --- DOWNLOAD DOCUMENTOS (Etapa 10 - NOVO) ---
        function downloadStep10Doc() {
            const docSelect = document.getElementById('step10-doc-select');
            const selectedDoc = docSelect.value;
            if (selectedDoc) {
                const link = document.createElement('a');
                link.href = selectedDoc;
                link.target = '_blank';
                link.download = selectedDoc.split('/').pop();
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert("Por favor, selecione um arquivo (Formulário ou ATA).");
            }
        }
        
        document.getElementById('upload-modal').addEventListener('click', function(e) { if (e.target === this) closeUploadModal(); });

        // ===============================================
        // DADOS DAS ETAPAS (TEXTOS DESCRITIVOS COMPLETOS)
        // ===============================================
        const stepData = {
            1: {
                title: "Seleção da Região",
                subtitle: "Fase 1: Acesso Inicial",
                text: "Nesta etapa, o supervisor deve identificar sua unidade de atuação (Campo Mourão, Francisco Beltrão, etc.). Ao selecionar e acessar, você será redirecionado para a planilha de gestão específica daquela região no SharePoint."
            },
            2: {
                title: "Execução no Desktop",
                subtitle: "Fase 1: Configuração Técnica",
                text: `
                    <p style="margin-bottom: 10px;"><strong>Como preparar a planilha para rodar as macros automatizadas:</strong></p>
                    <ol style="margin-left: 20px; margin-bottom: 15px; line-height: 1.6;">
                        <li>Abra a planilha da sua região.</li>
                        <li>Clique em <strong>"Exibir pasta de trabalho em tela inteira"</strong> (ícone de duas janelas no canto inferior direito).</li>
                        <li>Uma nova janela será aberta no Excel Online.</li>
                        <li>No menu superior, clique em <strong>Exibição</strong>.</li>
                        <li>Clique em <strong>"Abrir na área de trabalho"</strong>.</li>
                    </ol>
                    <p>Isso abrirá a planilha no Excel em sua versão desktop.</p>
                    
                    <!-- VÍDEO TUTORIAL -->
                    <div class="video-container">
                        <iframe width="560" height="315" src="https://www.youtube.com/embed/2uj-wwyg7YY" title="Habilitando Macros" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <p style="text-align: center; margin-top: 10px;">
                        <a href="https://youtu.be/2uj-wwyg7YY" target="_blank" style="color: var(--senac-blue); font-size: 0.9rem; font-weight: bold; text-decoration: underline;">
                            <i class="fab fa-youtube"></i> Caso não carregue, assista aqui
                        </a>
                    </p>
                    <p style="font-size: 0.8rem; color: #666; text-align: center; margin-top: 5px;"><em>Vídeo tutorial: Passo a passo no Excel</em></p>

                    <p style="color: var(--senac-green); font-weight: bold; margin-top: 20px; border-left: 4px solid var(--senac-green); padding-left: 10px; background: #f0fdf4; padding: 10px;">
                        <i class="fas fa-check-circle"></i> Pronto!<br>
                        A planilha estará pronta para rodar as macros de forma automatizada.
                    </p>

                    <div class="warning-box" style="margin-top: 20px; display: block;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; color: #c2410c;">
                            <i class="fas fa-exclamation-triangle" style="font-size: 1.2rem;"></i>
                            <strong>! Atenção !</strong>
                        </div>
                        <p style="margin-bottom: 5px;">Caso apareça alguma mensagem de erro ao tentar rodar as macros, siga estas etapas:</p>
                        <ol style="margin-left: 20px; margin-top: 5px;">
                            <li>Clique em <strong>Arquivo</strong> no canto superior esquerdo.</li>
                            <li>Selecione <strong>Central de Confiabilidade</strong>.</li>
                            <li>Clique em <strong>Configurações da Central de Confiabilidade</strong>.</li>
                            <li>Vá até <strong>Configurações de Macro</strong> e marque a opção <strong>“Habilitar macros VBA”</strong>.</li>
                            <li>Clique em <strong>OK</strong> para confirmar.</li>
                        </ol>
                    </div>
                `
            },
            3: {
                title: "Download de Documentos",
                subtitle: "Fase 1: Materiais de Apoio",
                text: "Aqui você encontra todos os arquivos padronizados necessários para o processo de supervisão. Certifique-se de baixar a versão mais recente dos manuais e formulários antes de iniciar as visitas."
            },
            4: {
                title: "Planilha de Planejamento",
                subtitle: "Fase 1: Organização",
                text: "A planilha central onde todas as visitas são agendadas e monitoradas. Mantenha este documento sempre atualizado para que a coordenação regional possa acompanhar o progresso em tempo real."
            },
            5: {
                title: "Configuração das Abas",
                subtitle: "Fase 1: Setup",
                text: "Antes de inserir dados, renomeie as abas conforme a nomenclatura padrão (ex: Cidade/Mês) para manter o histórico organizado."
            },
            6: {
                title: "Montar Logística",
                subtitle: "Fase 2: Roteirização",
                text: `
                    <p>Planeje os horários e o roteiro das visitas agrupando empresas próximas geograficamente. Essa estratégia otimiza o tempo de deslocamento, reduz custos operacionais e torna a agenda mais eficiente. Utilize ferramentas de mapa sempre que necessário para apoiar o planejamento.</p>
                    <p style="margin-top: 15px;">Em seguida, entre em contato com as empresas para confirmar as seguintes informações: nome do jovem aprendiz, horário de trabalho, contraturno escolar e endereço da empresa. Essa verificação garante que a visita seja realizada conforme o planejamento estabelecido.</p>
                    
                    <p style="text-align: center; margin-top: 20px;">
                        <a href="https://leobaurdossantos.wixsite.com/rota-f" target="_blank" style="color: var(--senac-blue); font-weight: bold; text-decoration: underline;">
                            <i class="fas fa-external-link-alt"></i> Acessar Site Rota Fácil
                        </a>
                    </p>

                    <!-- VÍDEO TUTORIAL -->
                    <div class="video-container" style="margin-top: 10px;">
                        <iframe width="560" height="315" src="https://www.youtube.com/embed/rfAOQMPZp7w" title="Rota Fácil" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <p style="text-align: center; margin-top: 10px;">
                        <a href="https://youtu.be/rfAOQMPZp7w" target="_blank" style="color: var(--senac-blue); font-size: 0.9rem; font-weight: bold; text-decoration: underline;">
                            <i class="fab fa-youtube"></i> Caso não carregue, assista aqui
                        </a>
                    </p>
                    <p style="font-size: 0.8rem; color: #666; text-align: center; margin-top: 5px;"><em>Rota Fácil o aplicativo para criar as melhores rotas</em></p>
                `
            },
            7: {
                title: "Aprovação da Agenda",
                subtitle: "Fase 2: Validação",
                text: "Após montar o roteiro preliminar, sinalize para o Polo-PR e Polo atuante e aguarde o 'De Acordo' antes de prosseguir com as visitas."
            },
            8: {
                title: "Abertura de Viagem",
                subtitle: "Fase 2: Administrativo",
                text: "Com a agenda aprovada, inicie o processo administrativo de solicitação de viagem (adiantamento, veículo, hospedagem) conforme as normas internas do Senac PR."
            },
            9: {
                title: "Confirmação com Empresas",
                subtitle: "Fase 2: Agendamento",
                text: "Entre em contato com os supervisores nas empresas para confirmar data, hora, endereço, nome e horário do jovem e contraturno escolar. Envie e-mails formais de confirmação para registrar o compromisso."
            },
            10: {
                title: "Formulário e/ou ATA",
                subtitle: "Fase 3: Preparação",
                text: "Certifique-se de ter em mãos o formulário de supervisão correto para a realização da visita. Caso necessário tenha em mãos a ATA para registro de situações que fogem do âmbito Formulário."
            },
            11: {
                title: "Preenchimento Inicial",
                subtitle: "Fase 3: Dados Básicos",
                text: "Para otimizar o tempo durante a visita, preencha previamente o cabeçalho do formulário com os dados da empresa, do aprendiz, do curso, do supervisor e a data. Certifique-se de que todos os campos estejam devidamente preenchidos, evitando deixar informações em branco. Além disso, garanta que todas as vias do documento sejam assinadas pelos participantes, assegurando a validade e a conformidade do registro."
            },
            12: {
                title: "Relatório de Desempenho",
                subtitle: "Fase 3: Análise Prévia",
                text: "Consulte o dashboard de desempenho do aluno. Verifique notas, frequência e ocorrências anteriores para ter embasamento durante a conversa com o supervisor da empresa."
            },
            13: {
                title: "A Entrevista",
                subtitle: "Fase 3: Ação",
                text: "Este é o momento central da visita. Converse inicialmente com o supervisor da empresa sobre a evolução do(a) aprendiz e, na sequência, com o próprio aprendiz. Registre de forma clara os pontos fortes, os pontos de melhoria e as situações ocorridas ao longo do período de prática. <br><br><strong>Lembre-se:</strong> sempre que necessário, utilize o documento <strong>ATA</strong> para formalizar os registros que fogem do âmbito Formulário."
            },
            14: {
                title: "Digitalização e Envio",
                subtitle: "Fase 4: Documentação",
                text: "Após a visita, digitalize o formulário assinado. Salve o arquivo seguindo o padrão de nomenclatura (Turma + Nome do Aluno) e faça o upload na pasta segura da região correspondente."
            },
            15: {
                title: "Registro na Planilha",
                subtitle: "Fase 4: Atualização de Status",
                text: "Retorne à planilha de planejamento e atualize o status da visita para 'Realizada', para efetuar o envio do e-mail de agradecimento e foto de registro da visita. Insira observações sucintas sobre o resultado da supervisão caso necessário na aba de dados gerais."
            },
            16: {
                title: "Informações para Rateio",
                subtitle: "Fase 4: Gestão e Controle",
                text: `
                    <p style="margin-bottom: 15px;">Após finalizar as visitas programadas, siga as orientações abaixo:</p>
                    <p>Acesse a aba de planejamento da planilha e preencha todos os dados referentes ao dia de visitas.</p>
                    
                    <strong style="display:block; margin-top: 15px; color: var(--senac-blue);">Registre as seguintes informações:</strong>
                    <ul style="margin-left: 20px; list-style-type: disc; margin-bottom: 20px;">
                        <li>Data da visita;</li>
                        <li>Cidades de deslocamento;</li>
                        <li>Horários de cada visita realizada;</li>
                        <li>Horário de almoço;</li>
                        <li>Quilometragem (Km) percorrida entre as cidades visitadas;</li>
                        <li>Valor de pedágio, se houver.</li>
                    </ul>

                    <div class="warning-box" style="border-left: 4px solid var(--senac-blue); background-color: #eff6ff; display: block;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; color: var(--senac-blue);">
                            <i class="fas fa-info-circle" style="font-size: 1.2rem;"></i>
                            <strong>Atenção à fidelidade das informações:</strong>
                        </div>
                        <p>Esses dados serão utilizados para o preenchimento das informações para fins de rateio. Por isso, é fundamental que todas as informações registradas estejam fidedignas à realidade.</p>
                    </div>

                    <p style="margin-top: 20px;"><strong>Após concluir o preenchimento:</strong></p>
                    <p>Sinalize o Polo-PR para que as informações sejam conferidas e, posteriormente, enviadas por e-mail ao supervisor e ao polo participante.</p>
                `
            },
            17: {
                title: "Envio Malote",
                subtitle: "Fase 4: Logística Física",
                text: `
                    <h3 style="color: var(--senac-dark-blue); font-size: 1.1rem; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">Encaminhamento de documentos para fechamento mensal</h3>
                    <p style="margin-bottom: 20px;">Ao finalizar todos os processos citados anteriormente, para o fechamento do mês, o polo atuante deverá encaminhar de forma física todos os documentos utilizados durante as visitas, para fins de arquivamento, seguindo as etapas abaixo:</p>
                    
                    <div style="background-color: #f8fafc; border-radius: 8px; padding: 20px; border: 1px solid #e2e8f0; margin-bottom: 20px;">
                        <div style="display: flex; align-items: flex-start; gap: 12px; margin-bottom: 15px;">
                            <div style="background: var(--senac-orange); color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 12px; font-weight: bold;">1</div>
                            <div>
                                <strong style="color: var(--senac-blue); display: block; margin-bottom: 5px;">Conferência da documentação:</strong>
                                <p style="font-size: 0.95rem; color: #4b5563;">Certifique-se de que todos os documentos estejam completos, devidamente preenchidos e assinados.</p>
                            </div>
                        </div>

                        <div style="display: flex; align-items: flex-start; gap: 12px;">
                            <div style="background: var(--senac-orange); color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 12px; font-weight: bold;">2</div>
                            <div>
                                <strong style="color: var(--senac-blue); display: block; margin-bottom: 5px;">Envio da documentação:</strong>
                                <p style="font-size: 0.95rem; color: #4b5563;">Encaminhe os documentos via malote para <strong>Senac Portão (Curitiba)</strong>.</p>
                            </div>
                        </div>
                    </div>

                    <div style="background-color: #eff6ff; border-left: 4px solid var(--senac-blue); padding: 15px; border-radius: 4px;">
                        <p style="font-size: 0.9rem; color: #1e3a8a; margin: 0;">
                            <i class="fas fa-user-tag" style="margin-right: 8px;"></i>
                            <strong>Aos cuidados de:</strong> Michel Vieira Farias – EAD.
                        </p>
                    </div>
                `
            },
            18: {
                title: "Conclusão do Ciclo",
                subtitle: "Fase 4: Fechamento",
                text: "Com todos os passos anteriores concluídos, sinalize ao Polo-PR o fechamento do ciclo de visitas do mês. O processo está finalizado!"
            }
        };

        function openStepInfo(stepId) {
            const data = stepData[stepId];
            if (data) {
                document.getElementById('step-modal-title').innerText = data.title;
                document.getElementById('step-modal-subtitle').innerText = data.subtitle;
                // ALTERADO DE innerText PARA innerHTML PARA PERMITIR FORMATAÇÃO
                document.getElementById('step-modal-content').innerHTML = data.text;
                
                document.getElementById('step-detail-modal').classList.add('active');
            }
        }

        function closeStepInfo() {
            document.getElementById('step-detail-modal').classList.remove('active');
        }

        // Fechar ao clicar fora
        document.getElementById('step-detail-modal').addEventListener('click', function(e) {
            if (e.target === this || e.target.classList.contains('modal-glass')) {
                // Se clicar no overlay (fora da caixa), fecha. 
            }
             if (e.target === this) closeStepInfo();
        });

        // ==========================================
        // LÓGICA DO PAINEL BI (DADOS)
        // ==========================================
        let biDb = { qualificacao: [], tecnico: [] };
        let biCurrentScope = 'qualificacao';
        let biFilteredData = [];
        let biChartStatusInstance = null;
        let biChartRegiaoInstance = null;
        let biChartFinanceInstance = null;
        const PREDEFINED_REGIONS = ["APUCARANA", "CAMPO MOURÃO", "CASCAVEL", "CURITIBA", "FOZ DO IGUAÇU", "FRANCISCO BELTRÃO", "GUARAPUAVA", "LONDRINA", "MARINGÁ", "PATO BRANCO", "PONTA GROSSA", "TOLEDO", "UMUARAMA", "UNIÃO DA VITÓRIA"];

        function initBiUsers() {
            const sel = document.getElementById('biFilterRegiao');
            if(sel) {
                sel.innerHTML = '<option value="">Todas as Regiões</option>';
                PREDEFINED_REGIONS.forEach(r => sel.innerHTML += `<option value="${r}">${r}</option>`);
            }
            tryLoadBiDefault();
        }

        async function tryLoadBiDefault() {
            try {
                // Tenta carregar um arquivo local padrão se existir
                const response = await fetch('Dados Gerais.xlsm');
                if(response.ok) {
                    const blob = await response.blob();
                    processBiFile({files: [new File([blob], "Dados Gerais.xlsm")]});
                }
            } catch(e) {}
        }

        function switchBiTab(tabName) {
            document.getElementById('biTabQualificacao').classList.remove('active');
            document.getElementById('biTabTecnico').classList.remove('active');
            document.getElementById('biTabFinanceiro').classList.remove('active');
            
            const viewDash = document.getElementById('biViewDashboard');
            const viewFin = document.getElementById('biViewFinanceiro');

            if(tabName === 'financeiro') {
                document.getElementById('biTabFinanceiro').classList.add('active');
                viewDash.classList.add('hidden');
                viewFin.classList.remove('hidden'); viewFin.classList.add('flex');
                updateBiFinancials();
            } else {
                biCurrentScope = tabName;
                if(tabName === 'qualificacao') document.getElementById('biTabQualificacao').classList.add('active');
                if(tabName === 'tecnico') document.getElementById('biTabTecnico').classList.add('active');
                viewDash.classList.remove('hidden');
                viewFin.classList.add('hidden'); viewFin.classList.remove('flex');
                applyBiFilters();
            }
        }

        function processBiFile(input) {
            const file = input.files[0];
            if(!file) return;
            document.getElementById('biLoadingSpinner').classList.remove('hidden');
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                
                let sheetQ = workbook.SheetNames.find(n => n.includes("Dados Gerais") && !n.includes("Tec"));
                let sheetT = workbook.SheetNames.find(n => n.includes("Dados Gerais") && n.includes("Tec"));
                if(!sheetQ) sheetQ = workbook.SheetNames[0];

                biDb.qualificacao = sheetQ ? parseBiSheet(workbook.Sheets[sheetQ]) : [];
                biDb.tecnico = sheetT ? parseBiSheet(workbook.Sheets[sheetT]) : [];

                document.getElementById('biLoadingSpinner').classList.add('hidden');
                document.getElementById('biBtnUploadText').innerText = "Atualizado";
                switchBiTab(biCurrentScope);
            };
            reader.readAsArrayBuffer(file);
        }

        function parseBiSheet(ws) {
            const json = XLSX.utils.sheet_to_json(ws, {header: 1, defval: ""});
            if(json.length < 2) return [];
            const headers = json[0].map(h => String(h).trim());
            const getIdx = (key) => headers.findIndex(h => h.toLowerCase().includes(key.toLowerCase()));
            
            // Índices baseados na estrutura padrão do Senac
            const idx = {
                nome: getIdx("Nome"), turma: getIdx("Turma"), cidade: getIdx("Cidade"), regiao: getIdx("Região"),
                empresa: getIdx("Empresa"), status: getIdx("Status"), dtIni: getIdx("Ini"), dtFim: getIdx("Fim")
            };

            return json.slice(1).map((row, i) => ({
                id: i,
                nome: row[idx.nome] || row[0] || "Desconhecido",
                turma: row[idx.turma] || row[1] || "",
                cidade: row[idx.cidade] || "N/A",
                regiao: row[idx.regiao] || "Geral",
                empresa: row[idx.empresa] || "",
                status: "No Prazo" // Simplificação para demonstração
            }));
        }

        function applyBiFilters() {
            const search = document.getElementById('biFilterSearch').value.toLowerCase();
            const regiao = document.getElementById('biFilterRegiao').value;
            const cidade = document.getElementById('biFilterCidade').value;
            
            biFilteredData = (biDb[biCurrentScope] || []).filter(item => {
                if(search && !item.nome.toLowerCase().includes(search)) return false;
                if(regiao && item.regiao !== regiao) return false;
                if(cidade && item.cidade !== cidade) return false;
                return true;
            });
            updateBiDashboard();
        }

        function handleBiRegionChange() {
            const regiao = document.getElementById('biFilterRegiao').value;
            const cidades = [...new Set((biDb[biCurrentScope]||[]).filter(i => !regiao || i.regiao === regiao).map(i => i.cidade))].sort();
            const sel = document.getElementById('biFilterCidade');
            sel.innerHTML = '<option value="">Todas as Cidades</option>';
            cidades.forEach(c => sel.innerHTML += `<option value="${c}">${c}</option>`);
            applyBiFilters();
        }

        function updateBiDashboard() {
            document.getElementById('biKpiTotal').innerText = biFilteredData.length;
            renderBiTable();
            renderBiCharts();
        }

        function renderBiTable() {
            const tbody = document.getElementById('biTableBody');
            tbody.innerHTML = '';
            if(biFilteredData.length === 0) {
                tbody.innerHTML = `<tr><td colspan="3" class="p-8 text-center text-gray-400">Nenhum dado encontrado. Carregue um arquivo Excel.</td></tr>`;
                return;
            }
            biFilteredData.slice(0, 50).forEach(item => {
                tbody.innerHTML += `
                    <tr class="hover:bg-slate-50 border-b border-slate-50">
                        <td class="p-4">
                            <div class="font-bold text-slate-700 text-sm">${item.nome}</div>
                            <div class="text-xs text-slate-400">${item.turma}</div>
                        </td>
                        <td class="p-4 text-xs text-slate-600">
                            ${item.empresa}<br><span class="text-slate-400">${item.cidade}</span>
                        </td>
                        <td class="p-4 text-center">
                            <span class="px-2 py-1 bg-emerald-100 text-emerald-700 rounded text-xs font-bold">${item.status}</span>
                        </td>
                    </tr>`;
            });
        }

        function renderBiCharts() {
            const ctxStatus = document.getElementById('biChartStatus');
            if(ctxStatus) {
                if(biChartStatusInstance) biChartStatusInstance.destroy();
                biChartStatusInstance = new Chart(ctxStatus, {
                    type: 'doughnut',
                    data: {
                        labels: ['No Prazo', 'Atrasado'],
                        datasets: [{ data: [biFilteredData.length, 0], backgroundColor: ['#10b981', '#ef4444'], borderWidth: 0 }]
                    },
                    options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { display: false } } }
                });
            }
            const ctxReg = document.getElementById('biChartRegiao');
            if(ctxReg) {
                if(biChartRegiaoInstance) biChartRegiaoInstance.destroy();
                // Dados simulados para o gráfico até que o Excel seja carregado
                const data = biFilteredData.length ? [biFilteredData.length] : [0];
                biChartRegiaoInstance = new Chart(ctxReg, {
                    type: 'bar',
                    data: { labels: ['Total'], datasets: [{ label: 'Jovens', data: data, backgroundColor: '#004587' }] },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
                });
            }
        }

        function updateBiFinancials() {
            const budget = parseFloat(document.getElementById('biInputBudget').value) || 0;
            const cost = parseFloat(document.getElementById('biInputCost').value) || 0;
            const pending = 10; // Exemplo fixo
            const projected = pending * cost;
            const balance = budget - projected;
            
            document.getElementById('biFinPendingVisits').innerText = pending;
            document.getElementById('biFinProjectedCost').innerText = "R$ " + projected.toFixed(2);
            document.getElementById('biFinBalance').innerText = "R$ " + balance.toFixed(2);
            
            const badge = document.getElementById('biFinStatusBadge');
            if(balance >= 0) { badge.innerText = "Positivo"; badge.className = "px-4 py-1 rounded-full text-xs font-bold uppercase bg-emerald-100 text-emerald-700 inline-block"; }
            else { badge.innerText = "Negativo"; badge.className = "px-4 py-1 rounded-full text-xs font-bold uppercase bg-red-100 text-red-700 inline-block"; }
            
            const ctx = document.getElementById('biChartFinance');
            if(ctx) {
                if(biChartFinanceInstance) biChartFinanceInstance.destroy();
                biChartFinanceInstance = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: ['Orçamento', 'Projetado'], datasets: [{ data: [budget, projected], backgroundColor: ['#10b981', balance >=0 ? '#3b82f6' : '#ef4444'] }] },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
                });
            }
        }

        function exportBiReport() {
            const ws = XLSX.utils.json_to_sheet(biFilteredData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Relatorio");
            XLSX.writeFile(wb, "Relatorio_BI.xlsx");
        }
    </script>
</body>
</html>